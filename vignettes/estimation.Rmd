---
title: "Estimation"
author: "Matthieu Stigler"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Estimation}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(collapse = T, comment = "#>")
```

Load the package, and load the built-in dataset from [Lee 2008]:

```{r}
library(RDDtools)
data(Lee2008)
```

Declare the data to be a *RDDdata* object:

```{r}
Lee2008_rdd <- RDDdata(y=Lee2008$y, x=Lee2008$x, cutpoint=0)
```

# Parametric

Estimate parametrically, by fitting a 4th order polynomial.

```{r reg_para}
reg_para <- RDDreg_lm(RDDobject=Lee2008_rdd, order=4)
reg_para

plot(reg_para)
```


# Non-parametric

Run a simple local regression, using the [Imbens and Kalyanaraman 2012] bandwidth.

```{r RegPlot}
bw_ik <- RDDbw_IK(Lee2008_rdd)
reg_nonpara <- RDDreg_np(RDDobject=Lee2008_rdd, bw=bw_ik)
print(reg_nonpara)
plot(x=reg_nonpara)

```
